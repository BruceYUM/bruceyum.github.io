# Redis 概述

[toc]

## 是什么

> Redis（Remote Dictionary Server )，即远程字典服务，是一个开源的使用 ANSI C 语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value 数据库，并提供多种语言的API。--百度百科

## 为什么

为什么有了 MySQL 还需要 Redis ？MySQL 性能问题？那为什么不只使用Redis（在某些场景下）

## 怎么用

### 1、Redis 安装及启动

**1. 安装**
```
$ wget http://download.redis.io/releases/redis-3.0.7.tar.gz 
$ tar xzf redis-3.0.7.tar.gz
$ ln -s redis-3.0.7 redis
$ cd redis
$ make
$ make install
```
1）下载 Redis 指定版本的源码压缩包到当前目录。
2）解压缩 Redis 源码压缩包。
3）建立一个 redis 目录的软连接，指向 redis-3.0.7。
4）进入 redis 目录。
5）编译（编译之前确保操作系统已经安装 gcc）。
6）安装。

**2. 启动服务器**
Redis安装之后，/usr/local/bin 目录下多了几个以 redis 开头可执行文件：
![image-20210612175615453](https://gitee.com/bruceyum/pictures/raw/master/pics/image-20210612175615453.png)

启动命令
安装完之后可以通过redis-server脚本启动Redis服务器，并且可以指定配置文件和端口等参数：

```
$ redis-server 							//默认配置启动
$ redis-server --port 6380				//指定启动端口			
$ redis-server /opt/redis/redis.conf	//指定配置文件
```
**3. 客户端连接**
redis-cli 是命令行客户端，可以通过 redis-cli-h{host}-p{port} 方式连接到 Redis 服务器。如果没有 -h 参数，那么默认连接 127.0.0.1；如果没有 -p，那么默认 6379 端口，也就是说如果 -h 和 -p 都没写就是连接 127.0.0.1：6379 这个 Redis 实例

```
redis-cli -h 127.0.0.1 -p 6379
127.0.0.1:6379> 
```

### 2、常用数据类型及命令

| 命令                                                         | 备注                                                         | 示例                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 字符串类型                                                   | 字符串类型的值实际可以是字符串、数字、二进制                 |                                                              |
| set key value [ex seconds] [px milliseconds] [nx\|xx]        | 设置字符串类型值 <br />ex seconds：为键设置秒级过期时间。 px milliseconds：为键设置毫秒级过期时间。 nx：键必须不存在，才可以设置成功，用于添加。 ·xx：与nx相反，键必须存在，才可以设置成功，用于更新。 | set hello world                                              |
| get key                                                      | 获取值                                                       | get hello                                                    |
| mset key value [key value ...]                               | 批量设置值                                                   | mset a 1 b 2 c 3 d 4                                         |
| mget key [key ...]                                           | 批量获取值                                                   | mget a b c d                                                 |
| incr key decr key incrby key increment decrby key decrement incrbyfloat key increment | 自增 自减 自增指定数字 自减指定数字 自增浮点数               |                                                              |
| 哈希类型                                                     |                                                              |                                                              |
| hset key field value                                         | 设置值                                                       | hset user:1 name tom hset user:1 age 28                      |
| hget key field                                               | 获取值                                                       | hget user:1 name                                             |
| hdel key field [field ...]                                   | 删除键                                                       | hdel user:1 name                                             |
| hmget key field [field ...] hmset key field value [field value ...] | 批量设置或获取field-value                                    | hmget user:1 name city                                       |
| hkeys key                                                    | 获取所有field                                                |                                                              |
| hvals key                                                    | 获取所有value                                                |                                                              |
| hgetall key                                                  | 获取所有的field-value                                        |                                                              |
| hincrby key field  hincrbyfloat key field                    | 自增                                                         |                                                              |
| 列表类型                                                     | list类型是用来存储多个有序的字符串                           |                                                              |
| rpush key value [value ...] lpush key value [value ...]      | 从右边插入元素 从左边插入元素                                | rpush listkey c b a                                          |
| lrange key start end llen key                                | 获取指定范围内的元素列表 获取列表长度                        |                                                              |
| lpop key rpop key                                            | 从列表左侧弹出元素 从列表右侧弹出                            | ·lpush+lpop=Stack（栈） ·lpush+rpop=Queue（队列） ·lpsh+ltrim=Capped Collection（有限集合） ·lpush+brpop=Message Queue（消息队列） |
| lrem key count value                                         | 删除指定元素：·count>0，从左到右，删除最多count个元素。 ·count<0，从右到左，删除最多count绝对值个元素。 ·count=0，删除所有。 |                                                              |
| blpop key [key ...] timeout brpop key [key ...] timeout      | 阻塞式弹出：客户端要等到timeout=n秒后返回，如果timeout=0，那么客户端一直阻塞 如果是多个键，那么brpop会从左至右遍历键，一旦有一个键能弹出元素，客户端立即 |                                                              |
| 集合类型                                                     | 集合中不允许有重复元素，并且是无序的                         |                                                              |
| sadd key element [element ...]                               | 添加元素                                                     | sadd myset a b c                                             |
| srem key element [element ...]                               | 删除元素                                                     | srem myset a b                                               |
| scard key                                                    | 获取元素个数                                                 |                                                              |
| sismember key element                                        | 判断元素是否在集合中                                         | sismember myset c                                            |
| spop key                                                     | 从集合随机弹出元素                                           |                                                              |
| smembers key                                                 | 获取所有元素                                                 |                                                              |
| sinter key [key ...]                                         | 多个集合的交集                                               |                                                              |
| suinon key [key ...]                                         | 多个集合的并集                                               |                                                              |
| sdiff key [key ...]                                          | 多个集合的差集                                               |                                                              |
| 有序集合                                                     | 集合不能有重复成员的特性，但有序集合中的元素可以排序         |                                                              |
| zadd key score member [score member ...]                     | 添加成员                                                     | zadd user:ranking 251 tom                                    |
| zcard key                                                    | 获取成员个数                                                 | zcard user:ranking                                           |
| zscore key member                                            | 获取某个成员的分数                                           |                                                              |
| zrank key member zrevrank key member                         | 获取成员的排名                                               |                                                              |
| zrem key member [member ...]                                 | 删除成员                                                     | zrem user:ranking mike                                       |
| zincrby key increment member                                 | 增加成员的分数                                               |                                                              |
| zrange    key start end [withscores] zrevrange key start end [withscores] | 返回指定排名范围的成员                                       |                                                              |
| zrangebyscore    key min max [withscores] [limit offset count] zrevrangebyscore key max min [withscores] [limit offset count] | 返回指定分数范围的成员                                       |                                                              |
| 键管理                                                       |                                                              |                                                              |
| keys *                                                       | 查看所有键：keys命令会遍历所有键，所以它的时间复杂度是O(n)   |                                                              |
| dbsize                                                       | 键总数                                                       |                                                              |
| exists key                                                   | 键存在则返回1，不存在则返回0                                 | exists hello                                                 |
| del key [key ...]                                            | del命令可以支持删除多个键                                    | del hello                                                    |
| expire key seconds                                           | 设置过期时间                                                 | expire hello 10                                              |
| type key                                                     | 键的数据结构类型                                             | type hello                                                   |

